<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BuyCar - Каталог автомобилей</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --background: #f8fafc;
            --foreground: #1f2937;
            --card-bg: #ffffff;
            --card-border: #e2e8f0;
        }

        .dark-theme {
            --primary: #60a5fa;
            --secondary: #94a3b8;
            --background: #111827;
            --foreground: #f3f4f6;
            --card-bg: #1f2937;
            --card-border: #374151;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--foreground);
            transition: all 0.3s ease;
        }

        .car-card {
            transition: all 0.3s ease;
            cursor: pointer;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
        }

        .car-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .filter-option {
            transition: all 0.2s ease;
        }

        .filter-option:hover, .filter-option.active {
            background-color: var(--primary);
            color: white;
        }

        .modal {
            transition: opacity 0.3s ease;
        }

        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .car-image {
            background: linear-gradient(135deg, var(--secondary), #9ca3af);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .cart-item {
            transition: all 0.2s ease;
        }

        .cart-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .nav-link {
            transition: all 0.2s ease;
        }

        .nav-link:hover {
            color: var(--primary);
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .hero-section {
            background: linear-gradient(rgba(30, 64, 175, 0.8), rgba(30, 64, 175, 0.9)), url('https://avatars.mds.yandex.net/i?id=71558d9fd7619e8eeeef385137f2f961_l-5179184-images-thumbs&n=13') center/cover;
        }

        .theme-toggle {
            transition: all 0.3s ease;
        }

        .payment-card {
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .payment-card.selected {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .auth-tab {
            transition: all 0.2s ease;
        }

        .auth-tab.active {
            background-color: var(--primary);
            color: white;
        }

        .form-input {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--foreground);
        }

        /* Мобильное меню */
        .mobile-menu {
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .mobile-menu.open {
            transform: translateX(0);
        }

        /* Анимации для кнопок */
        .btn-animate {
            transition: all 0.2s ease;
        }

        .btn-animate:active {
            transform: scale(0.95);
        }

        /* Анимация для уведомлений */
        .notification {
            animation: slideIn 0.5s ease, pulse 0.5s ease 0.5s;
        }

        /* Адаптивные улучшения */
        @media (max-width: 768px) {
            .car-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-content {
                padding: 2rem 1rem;
            }
            
            .filter-options {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .filter-option {
                font-size: 0.875rem;
                padding: 0.5rem 0.75rem;
            }
            
            .car-card {
                margin-bottom: 1rem;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .car-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1025px) {
            .car-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <!-- Верхнее навигационное меню -->
    <nav class="bg-white dark:bg-slate-800 shadow-md rounded-xl mb-8 p-4 flex justify-between items-center">
        <div class="flex items-center">
            <h1 class="text-2xl font-bold text-blue-600 dark:text-blue-400">BuyCar</h1>
            
            <!-- Десктопное меню -->
            <div class="ml-8 hidden md:flex space-x-6">
                <button data-section="home" class="nav-link font-medium text-blue-600 dark:text-blue-400">Главная</button>
                <button data-section="catalog" class="nav-link font-medium text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Каталог</button>
            </div>
            
            <!-- Кнопка мобильного меню -->
            <button id="mobile-menu-button" class="ml-4 md:hidden text-gray-600 dark:text-gray-300">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>
        
        <div class="flex items-center space-x-4">
            <!-- Переключение темы -->
            <button id="theme-toggle" class="theme-toggle p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 btn-animate">
                <i class="fas fa-moon"></i>
            </button>
            
            <!-- Кнопки авторизации -->
            <div id="auth-buttons">
                <button id="login-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors btn-animate">
                    Войти
                </button>
            </div>
            
            <!-- Кнопка корзины -->
            <div class="relative">
                <button id="cart-button" class="relative bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-colors btn-animate">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cart-count" class="cart-badge">0</span>
                </button>
            </div>
            
            <!-- Информация пользователя -->
            <div id="user-info" class="hidden items-center">
                <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center mr-2">
                    <i class="fas fa-user"></i>
                </div>
                <span id="username" class="font-medium hidden md:inline"></span>
                <button id="logout-btn" class="ml-4 text-red-500 hover:text-red-700 btn-animate">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Мобильное меню -->
    <div id="mobile-menu" class="mobile-menu fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-slate-800 shadow-lg md:hidden">
        <div class="p-4 border-b dark:border-gray-700">
            <h2 class="text-xl font-bold text-blue-600 dark:text-blue-400">Меню</h2>
            <button id="close-mobile-menu" class="absolute top-4 right-4 text-gray-500 dark:text-gray-300">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="p-4 space-y-4">
            <button data-section="home" class="w-full text-left py-2 font-medium text-blue-600 dark:text-blue-400">Главная</button>
            <button data-section="catalog" class="w-full text-left py-2 font-medium text-gray-600 dark:text-gray-300">Каталог</button>
        </div>
    </div>

    <!-- Главная страница -->
    <section id="home" class="section active">
        <div class="hero-section text-white rounded-2xl shadow-lg overflow-hidden mb-10">
            <div class="px-4 py-12 md:px-16 md:py-24 text-center">
                <h2 class="text-3xl md:text-5xl font-bold mb-4">Добро пожаловать в BuyCar</h2>
                <p class="text-lg md:text-2xl mb-8 max-w-3xl mx-auto">Ваш надежный партнер в поиске идеального автомобиля</p>
                <button data-section="catalog" class="bg-white text-blue-600 px-6 py-3 md:px-8 md:py-4 rounded-lg text-lg font-semibold hover:bg-blue-50 transition-colors btn-animate">
                    Посмотреть каталог
                </button>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8 mb-12 md:mb-16">
            <div class="bg-white dark:bg-slate-800 p-4 md:p-6 rounded-xl shadow-md text-center">
                <div class="bg-blue-100 dark:bg-blue-900 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                    <i class="fas fa-car text-xl md:text-2xl text-blue-600 dark:text-blue-400"></i>
                </div>
                <h3 class="text-lg md:text-xl font-semibold mb-2 dark:text-white">Широкий выбор</h3>
                <p class="text-sm md:text-base text-gray-600 dark:text-gray-300">Более 1000 автомобилей различных марок и моделей</p>
            </div>
            
            <div class="bg-white dark:bg-slate-800 p-4 md:p-6 rounded-xl shadow-md text-center">
                <div class="bg-green-100 dark:bg-green-900 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                    <i class="fas fa-shield-alt text-xl md:text-2xl text-green-600 dark:text-green-400"></i>
                </div>
                <h3 class="text-lg md:text-xl font-semibold mb-2 dark:text-white">Гарантия качества</h3>
                <p class="text-sm md:text-base text-gray-600 dark:text-gray-300">Все автомобили проходят тщательную проверку</p>
            </div>
            
            <div class="bg-white dark:bg-slate-800 p-4 md:p-6 rounded-xl shadow-md text-center">
                <div class="bg-purple-100 dark:bg-purple-900 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                    <i class="fas fa-hand-holding-usd text-xl md:text-2xl text-purple-600 dark:text-purple-400"></i>
                </div>
                <h3 class="text-lg md:text-xl font-semibold mb-2 dark:text-white">Лучшие цены</h3>
                <p class="text-sm md:text-base text-gray-600 dark:text-gray-300">Конкурентные цены и выгодные условия покупки</p>
            </div>
        </div>

        <div class="bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-6 md:p-8 mb-12 md:mb-16">
            <h2 class="text-2xl md:text-3xl font-bold text-center mb-4 md:mb-6 dark:text-white">Как это работает?</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6">
                <div class="text-center">
                    <div class="bg-white dark:bg-slate-800 w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md dark:text-white">1</div>
                    <h3 class="font-semibold text-sm md:text-base mb-1 md:mb-2 dark:text-white">Выберите авто</h3>
                    <p class="text-xs md:text-sm text-gray-600 dark:text-gray-300">Найдите подходящий автомобиль</p>
                </div>
                <div class="text-center">
                    <div class="bg-white dark:bg-slate-800 w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md dark:text-white">2</div>
                    <h3 class="font-semibold text-sm md:text-base mb-1 md:mb-2 dark:text-white">Добавьте в корзину</h3>
                    <p class="text-xs md:text-sm text-gray-600 dark:text-gray-300">Добавьте понравившиеся варианты</p>
                </div>
                <div class="text-center">
                    <div class="bg-white dark:bg-slate-800 w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md dark:text-white">3</div>
                    <h3 class="font-semibold text-sm md:text-base mb-1 md:mb-2 dark:text-white">Оформите заказ</h3>
                    <p class="text-xs md:text-sm text-gray-600 dark:text-gray-300">Заполните форму заказа</p>
                </div>
                <div class="text-center">
                    <div class="bg-white dark:bg-slate-800 w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md dark:text-white">4</div>
                    <h3 class="font-semibold text-sm md:text-base mb-1 md:mb-2 dark:text-white">Получите авто</h3>
                    <p class="text-xs md:text-sm text-gray-600 dark:text-gray-300">Заберите свой автомобиль</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Страница каталога -->
    <section id="catalog" class="section">
        <!-- Панель фильтров и поиска -->
        <div class="mb-6 md:mb-8 bg-white dark:bg-slate-800 p-4 rounded-xl shadow-md">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div class="w-full md:w-1/3">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="Поиск по марке или модели..." class="form-input w-full p-3 rounded-lg pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <i class="fas fa-search absolute left-3 top-3.5 text-gray-400"></i>
                    </div>
                </div>
                
                <div class="flex flex-wrap gap-2 w-full md:w-2/3 justify-start md:justify-end filter-options">
                    <span class="font-medium text-gray-700 dark:text-gray-300 hidden md:block">Сортировать по:</span>
                    <button class="filter-option px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-lg text-sm font-medium dark:text-white" data-sort="price-asc">Цене (возр.)</button>
                    <button class="filter-option px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-lg text-sm font-medium dark:text-white" data-sort="price-desc">Цене (убыв.)</button>
                    <button class="filter-option px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-lg text-sm font-medium dark:text-white" data-sort="year-desc">Новизне</button>
                    <button class="filter-option px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-lg text-sm font-medium dark:text-white" data-sort="mileage-asc">Пробегу</button>
                </div>
            </div>
        </div>

        <div>
            <div id="car-list" class="car-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
                <!-- Карточки автомобилей будут здесь -->
            </div>
            
            <div id="no-results" class="hidden text-center py-8 md:py-12">
                <i class="fas fa-car fa-4x md:fa-5x text-gray-300 mb-4"></i>
                <h3 class="text-xl md:text-2xl font-semibold text-gray-600 dark:text-gray-300">Ничего не найдено</h3>
                <p class="text-gray-500 dark:text-gray-400 mt-2">Попробуйте изменить параметры поиска или фильтры</p>
            </div>
        </div>
    </section>

    <!-- Модальное окно с деталями автомобиля -->
    <div id="car-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-white dark:bg-slate-800 p-4 border-b dark:border-gray-700 flex justify-between items-center rounded-t-xl">
                <h2 class="text-2xl font-bold dark:text-white" id="modal-title"></h2>
                <button id="close-modal" class="text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100 btn-animate">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div id="modal-image-container" class="w-full h-48 md:h-64 rounded-lg mb-6 car-image">
                    <!-- Изображение будет загружено через JS -->
                </div>
                <p id="modal-description" class="text-gray-700 dark:text-gray-300 mb-6"></p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                        <h3 class="font-semibold text-blue-800 dark:text-blue-300 mb-2">Характеристики</h3>
                        <ul class="space-y-2">
                            <li class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Год выпуска:</span> <span id="modal-year" class="font-medium dark:text-white"></span></li>
                            <li class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Пробег:</span> <span id="modal-mileage" class="font-medium dark:text-white"></span></li>
                            <li class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Марка:</span> <span id="modal-make" class="font-medium dark:text-white"></span></li>
                            <li class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Модель:</span> <span id="modal-model" class="font-medium dark:text-white"></span></li>
                        </ul>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                        <h3 class="font-semibold text-green-800 dark:text-green-300 mb-2">Финансовые детали</h3>
                        <div class="text-center">
                            <div id="modal-price" class="text-3xl font-bold text-green-700 dark:text-green-400 mb-4"></div>
                            <button class="add-to-cart-modal bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors w-full btn-animate">
                                <i class="fas fa-cart-plus mr-2"></i>Добавить в корзину
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно корзины -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-white dark:bg-slate-800 p-4 border-b dark:border-gray-700 flex justify-between items-center rounded-t-xl">
                <h2 class="text-2xl font-bold dark:text-white">Корзина</h2>
                <button id="close-cart-modal" class="text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100 btn-animate">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div id="cart-items" class="mb-6">
                    <!-- Товары в корзине будут здесь -->
                </div>
                
                <div id="cart-empty" class="text-center py-8">
                    <i class="fas fa-shopping-cart fa-4x text-gray-300 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-600 dark:text-gray-300">Ваша корзина пуста</h3>
                    <p class="text-gray-500 dark:text-gray-400 mt-2">Добавьте автомобили из каталога</p>
                </div>
                
                <div id="cart-total" class="border-t dark:border-gray-700 pt-4 hidden">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-lg font-semibold dark:text-white">Итого:</span>
                        <span id="total-price" class="text-2xl font-bold text-blue-600 dark:text-blue-400"></span>
                    </div>
                    <div class="flex space-x-4">
                        <button id="clear-cart-btn" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-medium hover:bg-gray-600 transition-colors btn-animate">
                            <i class="fas fa-trash mr-2"></i>Очистить
                        </button>
                        <button id="checkout-btn" class="flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors btn-animate">
                            Оформить заказ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно авторизации -->
    <div id="auth-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-md w-full">
            <div class="sticky top-0 bg-white dark:bg-slate-800 p-4 border-b dark:border-gray-700 flex justify-between items-center rounded-t-xl">
                <h2 class="text-2xl font-bold dark:text-white">Вход / Регистрация</h2>
                <button id="close-auth-modal" class="text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100 btn-animate">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="flex mb-6 bg-gray-100 dark:bg-gray-700 rounded-lg p-1">
                    <button data-tab="login" class="auth-tab flex-1 py-2 text-center rounded-lg">Вход</button>
                    <button data-tab="register" class="auth-tab flex-1 py-2 text-center rounded-lg">Регистрация</button>
                </div>
                
                <form id="login-form" class="auth-form space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1 dark:text-white">Имя пользователя</label>
                        <input type="text" required class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1 dark:text-white">Пароль</label>
                        <input type="password" required class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors btn-animate">
                        Войти
                    </button>
                </form>
                
                <form id="register-form" class="auth-form space-y-4 hidden">
                    <div>
                        <label class="block text-sm font-medium mb-1 dark:text-white">Имя</label>
                        <input type="text" required class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1 dark:text-white">Имя пользователя</label>
                        <input type="text" required class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1 dark:text-white">Пароль</label>
                        <input type="password" required class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1 dark:text-white">Подтверждение пароля</label>
                        <input type="password" required class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors btn-animate">
                        Зарегистрироваться
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Модальное окно оформления заказа -->
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-white dark:bg-slate-800 p-4 border-b dark:border-gray-700 flex justify-between items-center rounded-t-xl">
                <h2 class="text-2xl font-bold dark:text-white">Оформление заказа</h2>
                <button id="close-checkout-modal" class="text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100 btn-animate">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-4 dark:text-white">Способ оплаты</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="payment-card bg-gray-100 dark:bg-gray-700 p-4 rounded-lg cursor-pointer" data-payment="card">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white mr-3">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <span class="font-medium dark:text-white">Банковская карта</span>
                            </div>
                        </div>
                        <div class="payment-card bg-gray-100 dark:bg-gray-700 p-4 rounded-lg cursor-pointer" data-payment="cash">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center text-white mr-3">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <span class="font-medium dark:text-white">Наличные</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="card-payment-form" class="space-y-4 hidden">
                    <div class="bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg p-3 mb-4">
                        <p class="text-red-700 dark:text-red-300 text-sm font-medium">⚠️ Внимание: не вводите реальные данные карт! Это демонстрационный сайт.</p>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2 dark:text-white">Выберите карту</label>
                        <select class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="card1">Visa •••• 1234</option>
                            <option value="card2">Mastercard •••• 5678</option>
                            <option value="card3">Мир •••• 9012</option>
                        </select>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 dark:text-white">Номер карты</label>
                            <input type="text" placeholder="1234 5678 9012 3456" class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 dark:text-white">Срок действия</label>
                            <input type="text" placeholder="MM/ГГ" class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 dark:text-white">Владелец карты</label>
                            <input type="text" placeholder="IVAN IVANOV" class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 dark:text-white">CVV/CVC</label>
                            <input type="text" placeholder="123" class="form-input w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>
                
                <div id="cash-payment-info" class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg mb-4 hidden">
                    <p class="text-blue-800 dark:text-blue-300">Оплата производится при приезде в автосалон или при доставке автомобиля.</p>
                </div>
                
                <div class="mt-6 border-t dark:border-gray-700 pt-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-lg font-semibold dark:text-white">Итого:</span>
                        <span id="checkout-total-price" class="text-2xl font-bold text-blue-600 dark:text-blue-400"></span>
                    </div>
                    <button id="confirm-order-btn" class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors btn-animate">
                        Подтвердить заказ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Дисклеймер -->
    <div class="bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-xl p-4 mt-8 text-center text-sm text-red-700 dark:text-red-300">
        <p class="font-semibold">⚠️ Внимание: данный сайт создан исключительно в игровых и развлекательных целях.</p>
        <p class="mt-1">Все автомобили, цены и описания являются вымышленными и не относятся к реальным предложениям.</p>
    </div>

    <footer class="mt-12 text-center text-gray-500 dark:text-gray-400">
        <p>© 2023 BuyCar. Все права защищены.</p>
        <p class="mt-2">Для добавления новых машин, отредактируйте массив данных в коде.</p>
    </footer>

    <script>
        // Данные об автомобилях с актуальными ценами (основано на реальном рынке 2023)
        const cars = [
            {
                id: 1,
                make: 'Toyota',
                model: 'Camry',
                year: 2021,
                price: '2 350 000 ₽',
                numericPrice: 2350000,
                mileage: '45 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Отличный семейный автомобиль с низким расходом топлива и полным набором функций безопасности. Идеально подходит для городских поездок и длительных путешествий. Комфортный салон с качественными материалами и современной мультимедийной системой.',
            },
            {
                id: 2,
                make: 'BMW',
                model: 'X5',
                year: 2022,
                price: '6 900 000 ₽',
                numericPrice: 6900000,
                mileage: '20 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Роскошный внедорожник с мощным двигателем и элегантным интерьером. Идеально подходит для любых дорог. Оснащен передовыми технологиями безопасности и комфорта, включают адаптивный круиз-контроль, панорамную крышу и кожаный салон премиум-класса.',
            },
            {
                id: 3,
                make: 'Lada',
                model: 'Vesta SW Cross',
                year: 2023,
                price: '1 650 000 ₽',
                numericPrice: 1650000,
                mileage: '10 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Новый универсал с повышенной проходимостью. Надежный и практичный вариант для ежедневных поездок. Просторный багажник, экономичный двигатель и повышенный клиренс делают эту модель отличным выбором для российских дорог.',
            },
            {
                id: 4,
                make: 'Ford',
                model: 'Mustang',
                year: 2020,
                price: '3 800 000 ₽',
                numericPrice: 3800000,
                mileage: '30 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Легендарный спортивный автомобиль с классическим дизайном и потрясающей динамикой. Мощный V8 двигатель, задний привод и агрессивный дизайн делают Mustang мечтой многих автолюбителей.',
            },
            {
                id: 5,
                make: 'Mercedes-Benz',
                model: 'C-Class',
                year: 2021,
                price: '4 200 000 ₽',
                numericPrice: 4200000,
                mileage: '25 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Премиум-седан с высоким уровнем комфорта и передовыми технологиями. Элегантный экстерьер сочетается с роскошным интерьером, оснащенным современной информационно-развлекательной системой и системами помощи водителю.',
            },
            {
                id: 6,
                make: 'Kia',
                model: 'Rio',
                year: 2022,
                price: '1 350 000 ₽',
                numericPrice: 1350000,
                mileage: '15 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Популярный компактный седан с современным дизайном и экономичным двигателем. Отличный выбор для города.',
            },
            {
                id: 7,
                make: 'Hyundai',
                model: 'Tucson',
                year: 2021,
                price: '2 200 000 ₽',
                numericPrice: 2200000,
                mileage: '40 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Стильный кроссовер с просторным салоном и передовыми технологиями. Идеален для города и загородных поездок.',
            },
            {
                id: 8,
                make: 'Volkswagen',
                model: 'Tiguan',
                year: 2020,
                price: '2 500 000 ₽',
                numericPrice: 2500000,
                mileage: '50 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Немецкий кроссовер с отличной управляемостью и качественной сборкой. Просторный салон и экономичный двигатель.',
            },
            {
                id: 9,
                make: 'Skoda',
                model: 'Octavia',
                year: 2021,
                price: '1 900 000 ₽',
                numericPrice: 1900000,
                mileage: '35 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Практичный и надежный автомобиль с просторным салоном и багажником. Отличное сочетание цены и качества.',
            },
            {
                id: 10,
                make: 'Audi',
                model: 'A4',
                year: 2020,
                price: '3 500 000 ₽',
                numericPrice: 3500000,
                mileage: '40 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Премиальный седан с ярким дизайном и передовыми технологиями. Динамичный двигатель и качественная отделка салона.',
            },
            {
                id: 11,
                make: 'Nissan',
                model: 'Qashqai',
                year: 2022,
                price: '2 300 000 ₽',
                numericPrice: 2300000,
                mileage: '10 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Популярный кроссовер с современным дизайном и экономичными двигателями. Отличный выбор для города.',
            },
            {
                id: 12,
                make: 'Volvo',
                model: 'XC60',
                year: 2021,
                price: '4 800 000 ₽',
                numericPrice: 4800000,
                mileage: '25 000 км',
                imageUrl: 'https://avatars.mds.yandex.net/get-autoru-vos/2080157/2c91191e7b5a4d6d5b7e5d5c5b5e5d5d/1200x900',
                description: 'Безопасный и комфортный шведский кроссовер с элегантным дизайном и качественной отделкой салона.',
            }
        ];

        // Переменные для управления состоянием
        let filteredCars = [...cars];
        let currentSort = '';
        let cart = [];
        let currentCarInModal = null;
        let currentUser = null;
        let isDarkTheme = false;
        let currentPaymentMethod = '';

        // Функция для переключения тем
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            if (isDarkTheme) {
                document.documentElement.classList.add('dark-theme');
                document.getElementById('theme-toggle').innerHTML = '<i class="fas fa-sun"></i>';
                try {
                    localStorage.setItem('theme', 'dark');
                } catch (e) {
                    console.log('LocalStorage not available');
                }
            } else {
                document.documentElement.classList.remove('dark-theme');
                document.getElementById('theme-toggle').innerHTML = '<i class="fas fa-moon"></i>';
                try {
                    localStorage.setItem('theme', 'light');
                } catch (e) {
                    console.log('LocalStorage not available');
                }
            }
        }

        // Функция для переключения разделов
        function showSection(sectionId) {
            // Скрыть все разделы
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Показать выбранный раздел
            document.getElementById(sectionId).classList.add('active');
            
            // Обновить активную ссылку в навигации
            document.querySelectorAll('.nav-link').forEach(link => {
                if (link.dataset.section === sectionId) {
                    link.classList.add('text-blue-600', 'dark:text-blue-400');
                    link.classList.remove('text-gray-600', 'dark:text-gray-300');
                } else {
                    link.classList.remove('text-blue-600', 'dark:text-blue-400');
                    link.classList.add('text-gray-600', 'dark:text-gray-300');
                }
            });
            
            // Если переходим в каталог, отображаем автомобили
            if (sectionId === 'catalog') {
                renderCars(filteredCars);
            }
            
            // Закрыть мобильное меню после выбора раздела
            document.getElementById('mobile-menu').classList.remove('open');
        }

        // Функция для обновления счетчика корзины
        function updateCartCount() {
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cart-count').textContent = totalItems;
        }

        // Функция для добавления автомобиля в корзину
        function addToCart(carId) {
            const car = cars.find(c => c.id === carId);
            if (!car) return;
            
            const existingItem = cart.find(item => item.id === carId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: car.id,
                    make: car.make,
                    model: car.model,
                    price: car.price,
                    numericPrice: car.numericPrice,
                    imageUrl: car.imageUrl,
                    quantity: 1
                });
            }
            
            updateCartCount();
            showNotification(`${car.make} ${car.model} добавлен в корзину`);
        }

        // Функция для очистки корзины
        function clearCart() {
            if (cart.length === 0) return;
            
            cart = [];
            updateCartCount();
            renderCart();
            showNotification('Корзина очищена');
        }

        // Функция для удаления автомобиля из корзины
        function removeFromCart(carId) {
            const index = cart.findIndex(item => item.id === carId);
            if (index !== -1) {
                const car = cart[index];
                cart.splice(index, 1);
                updateCartCount();
                renderCart();
                showNotification(`${car.make} ${car.model} удален из корзины`);
            }
        }

        // Функция для изменения количества товара в корзине
        function updateCartItemQuantity(carId, change) {
            const item = cart.find(item => item.id === carId);
            if (item) {
                item.quantity += change;
                
                if (item.quantity <= 0) {
                    removeFromCart(carId);
                } else {
                    updateCartCount();
                    renderCart();
                }
            }
        }

        // Функция для показа уведомления
        function showNotification(message) {
            // Создаем элемент уведомления
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-transform duration-300 translate-x-full notification';
            notification.textContent = message;
            
            // Добавляем уведомление на страницу
            document.body.appendChild(notification);
            
            // Показываем уведомление
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Убираем уведомление через 3 секунды
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Функция для отображения корзины
        function renderCart() {
            const cartItemsContainer = document.getElementById('cart-items');
            const cartEmpty = document.getElementById('cart-empty');
            const cartTotal = document.getElementById('cart-total');
            const totalPriceElement = document.getElementById('total-price');
            
            cartItemsContainer.innerHTML = '';
            
            if (cart.length === 0) {
                cartEmpty.classList.remove('hidden');
                cartTotal.classList.add('hidden');
                return;
            }
            
            cartEmpty.classList.add('hidden');
            cartTotal.classList.remove('hidden');
            
            // Рассчитываем общую стоимость
            const totalPrice = cart.reduce((total, item) => total + (item.numericPrice * item.quantity), 0);
            totalPriceElement.textContent = `${totalPrice.toLocaleString('ru-RU')} ₽`;
            
            // Добавляем товары в корзину
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item flex items-center border-b dark:border-gray-700 pb-4 mb-4';
                cartItem.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.make} ${item.model}" class="w-20 h-14 object-cover rounded-lg mr-4" onerror="this.style.display='none';">
                    <div class="flex-grow">
                        <h3 class="font-semibold dark:text-white">${item.make} ${item.model}</h3>
                        <p class="text-blue-600 dark:text-blue-400 font-bold">${item.price}</p>
                    </div>
                    <div class="flex items-center">
                        <button class="decrease-quantity w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center mr-2" data-id="${item.id}">
                            <i class="fas fa-minus text-xs dark:text-white"></i>
                        </button>
                        <span class="quantity dark:text-white">${item.quantity}</span>
                        <button class="increase-quantity w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center ml-2" data-id="${item.id}">
                            <i class="fas fa-plus text-xs dark:text-white"></i>
                        </button>
                        <button class="remove-from-cart ml-4 text-red-500 hover:text-red-700" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                cartItemsContainer.appendChild(cartItem);
            });
            
            // Добавляем обработчики событий для кнопок корзины
            document.querySelectorAll('.increase-quantity').forEach(button => {
                button.addEventListener('click', (e) => {
                    const carId = parseInt(button.dataset.id);
                    updateCartItemQuantity(carId, 1);
                });
            });
            
            document.querySelectorAll('.decrease-quantity').forEach(button => {
                button.addEventListener('click', (e) => {
                    const carId = parseInt(button.dataset.id);
                    updateCartItemQuantity(carId, -1);
                });
            });
            
            document.querySelectorAll('.remove-from-cart').forEach(button => {
                button.addEventListener('click', (e) => {
                    const carId = parseInt(button.dataset.id);
                    removeFromCart(carId);
                });
            });
        }

        // Функция для создания HTML-карточки автомобиля
        function createCarCard(car) {
            const card = document.createElement('div');
            card.className = 'car-card bg-white dark:bg-slate-800 rounded-xl shadow-lg overflow-hidden';
            card.dataset.id = car.id;
            card.dataset.make = car.make.toLowerCase();
            card.dataset.model = car.model.toLowerCase();
            card.dataset.price = car.numericPrice;
            card.dataset.year = car.year;
            
            // Извлекаем числовое значение пробега для сортировки
            const numericMileage = parseInt(car.mileage.replace(/\s+/g, ''));
            card.dataset.mileage = numericMileage;

            // Заполнение HTML-карточки
            card.innerHTML = `
                <div class="w-full h-48 car-image">
                    <img src="${car.imageUrl}" alt="Фото ${car.make} ${car.model}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\'w-full h-full flex items-center justify-center\'><i class=\'fas fa-car text-5xl\'></i></div>';">
                </div>
                <div class="p-6">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-900 dark:text-white">${car.make} ${car.model}</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-4 line-clamp-2">${car.description}</p>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-3xl font-bold text-blue-600 dark:text-blue-400">${car.price}</span>
                    </div>
                    <ul class="text-gray-700 dark:text-gray-300 text-sm mb-4">
                        <li class="flex items-center mb-1">
                            <svg class="w-4 h-4 mr-2 text-gray-500 dark:text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10 2a8 8 0 100 16 8 8 0 000-16zM5 8h10V7H5V8zm0 2h10v-1H5v1zm0 2h7v-1H5v1z" clip-rule="evenodd" fill-rule="evenodd"></path>
                            </svg>
                            <span class="font-bold">Год:</span> ${car.year}
                        </li>
                        <li class="flex items-center mb-1">
                            <svg class="w-4 h-4 mr-2 text-gray-500 dark:text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10 2a8 8 0 100 16 8 8 0 000-16zM8 7a1 1 0 100 2h4a1 1 0 100-2H8z" clip-rule="evenodd" fill-rule="evenodd"></path>
                            </svg>
                            <span class="font-bold">Пробег:</span> ${car.mileage}
                        </li>
                    </ul>
                    <div class="flex space-x-3">
                        <button class="view-details flex-grow bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors btn-animate">
                            <i class="fas fa-info-circle mr-2"></i>Подробнее
                        </button>
                        <button class="add-to-cart w-12 bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center btn-animate" data-id="${car.id}">
                            <i class="fas fa-cart-plus"></i>
                        </button>
                    </div>
                </div>
            `;

            // Добавляем обработчик события для всей карточки
            card.addEventListener('click', (e) => {
                if (!e.target.classList.contains('view-details') && !e.target.classList.contains('add-to-cart') && 
                    !e.target.closest('.view-details') && !e.target.closest('.add-to-cart')) {
                    showCarDetails(car.id);
                }
            });

            // Добавляем обработчик для кнопки "Подробнее"
            const detailsBtn = card.querySelector('.view-details');
            detailsBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                showCarDetails(car.id);
            });

            // Добавляем обработчик для кнопки "Добавить в корзину"
            const addToCartBtn = card.querySelector('.add-to-cart');
            addToCartBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                addToCart(car.id);
            });

            return card;
        }

        // Функция для отображения всех автомобилей
        function renderCars(carsArray) {
            const carListContainer = document.getElementById('car-list');
            carListContainer.innerHTML = '';
            
            if (carsArray.length === 0) {
                document.getElementById('no-results').classList.remove('hidden');
                return;
            }
            
            document.getElementById('no-results').classList.add('hidden');
            
            carsArray.forEach(car => {
                const card = createCarCard(car);
                carListContainer.appendChild(card);
            });
        }

        // Функция для фильтрации автомобилей
        function filterCars() {
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            filteredCars = cars.filter(car => {
                return car.make.toLowerCase().includes(searchText) || 
                       car.model.toLowerCase().includes(searchText);
            });
            
            applySort();
        }

        // Функция для применения сортировки
        function applySort() {
            switch(currentSort) {
                case 'price-asc':
                    filteredCars.sort((a, b) => a.numericPrice - b.numericPrice);
                    break;
                case 'price-desc':
                    filteredCars.sort((a, b) => b.numericPrice - a.numericPrice);
                    break;
                case 'year-desc':
                    filteredCars.sort((a, b) => b.year - a.year);
                    break;
                case 'mileage-asc':
                    filteredCars.sort((a, b) => {
                        const aMileage = parseInt(a.mileage.replace(/\s+/g, ''));
                        const bMileage = parseInt(b.mileage.replace(/\s+/g, ''));
                        return aMileage - bMileage;
                    });
                    break;
                default:
                    // Без сортировки
                    break;
            }
            
            renderCars(filteredCars);
        }

        // Функция для показа деталей автомобиля
        function showCarDetails(carId) {
            const car = cars.find(c => c.id === carId);
            if (!car) return;
            
            currentCarInModal = car;
            
            document.getElementById('modal-title').textContent = `${car.make} ${car.model}`;
            
            const imageContainer = document.getElementById('modal-image-container');
            imageContainer.innerHTML = `<img src="${car.imageUrl}" alt="Фото ${car.make} ${car.model}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\'w-full h-full flex items-center justify-center\'><i class=\'fas fa-car text-5xl text-white\'></i><p class=\'ml-2 text-white\'>${car.make} ${car.model}</p></div>';">
            `;
            
            document.getElementById('modal-description').textContent = car.description;
            document.getElementById('modal-year').textContent = car.year;
            document.getElementById('modal-mileage').textContent = car.mileage;
            document.getElementById('modal-make').textContent = car.make;
            document.getElementById('modal-model').textContent = car.model;
            document.getElementById('modal-price').textContent = car.price;
            
            document.getElementById('car-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Функция для скрытия модального окна
        function hideCarDetails() {
            document.getElementById('car-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
            currentCarInModal = null;
        }

        // Функция для показа корзины
        function showCart() {
            renderCart();
            document.getElementById('cart-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Функция для скрытия корзины
        function hideCart() {
            document.getElementById('cart-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Функция для показа авторизации
        function showAuth() {
            document.getElementById('auth-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Функция для скрытия авторизации
        function hideAuth() {
            document.getElementById('auth-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Функция для показа оформления заказа
        function showCheckout() {
            if (!currentUser) {
                showAuth();
                return;
            }
            
            const totalPrice = cart.reduce((total, item) => total + (item.numericPrice * item.quantity), 0);
            document.getElementById('checkout-total-price').textContent = `${totalPrice.toLocaleString('ru-RU')} ₽`;
            
            document.getElementById('checkout-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Функция для скрытия оформления заказа
        function hideCheckout() {
            document.getElementById('checkout-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Функция для переключения способа оплаты
        function selectPaymentMethod(method) {
            currentPaymentMethod = method;
            
            document.querySelectorAll('.payment-card').forEach(card => {
                if (card.dataset.payment === method) {
                    card.classList.add('selected');
                } else {
                    card.classList.remove('selected');
                }
            });
            
            if (method === 'card') {
                document.getElementById('card-payment-form').classList.remove('hidden');
                document.getElementById('cash-payment-info').classList.add('hidden');
            } else if (method === 'cash') {
                document.getElementById('card-payment-form').classList.add('hidden');
                document.getElementById('cash-payment-info').classList.remove('hidden');
            }
        }

        // Функция для переключения вкладок авторизации
        function switchAuthTab(tabName) {
            document.querySelectorAll('.auth-tab').forEach(tab => {
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            document.querySelectorAll('.auth-form').forEach(form => {
                if (form.id === `${tabName}-form`) {
                    form.classList.remove('hidden');
                } else {
                    form.classList.add('hidden');
                }
            });
        }

        // Функция для входа пользователя
        function loginUser(username) {
            currentUser = {
                username: username,
                name: username
            };
            
            try {
                localStorage.setItem('user', JSON.stringify(currentUser));
            } catch (e) {
                console.log('LocalStorage not available');
            }
            
            document.getElementById('auth-buttons').classList.add('hidden');
            document.getElementById('user-info').classList.remove('hidden');
            document.getElementById('username').textContent = currentUser.name;
            
            hideAuth();
            showNotification(`Добро пожаловать, ${currentUser.name}!`);
        }

        // Функция для выхода пользователя
        function logoutUser() {
            currentUser = null;
            try {
                localStorage.removeItem('user');
            } catch (e) {
                console.log('LocalStorage not available');
            }
            
            document.getElementById('auth-buttons').classList.remove('hidden');
            document.getElementById('user-info').classList.add('hidden');
            
            showNotification('Вы вышли из системы');
        }

        // Функция для открытия/закрытия мобильного меню
        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('open');
        }

        // Запуск после загрузки DOM
        document.addEventListener('DOMContentLoaded', () => {
            // Проверяем сохраненную тему
            try {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') {
                    toggleTheme();
                }
            } catch (e) {
                console.log('LocalStorage not available');
            }
            
            // Проверяем сохраненного пользователя
            try {
                const savedUser = localStorage.getItem('user');
                if (savedUser) {
                    currentUser = JSON.parse(savedUser);
                    document.getElementById('auth-buttons').classList.add('hidden');
                    document.getElementById('user-info').classList.remove('hidden');
                    document.getElementById('username').textContent = currentUser.name;
                }
            } catch (e) {
                console.log('LocalStorage not available');
            }
            
            renderCars(cars);
            
            // Назначение обработчиков событий
            document.getElementById('search-input').addEventListener('input', filterCars);
            
            document.querySelectorAll('.filter-option').forEach(button => {
                button.addEventListener('click', () => {
                    currentSort = button.dataset.sort;
                    document.querySelectorAll('.filter-option').forEach(btn => {
                        btn.classList.remove('active');
                        btn.classList.remove('bg-blue-600', 'text-white');
                        btn.classList.add('bg-gray-200', 'dark:bg-gray-700');
                    });
                    button.classList.remove('bg-gray-200', 'dark:bg-gray-700');
                    button.classList.add('bg-blue-600', 'text-white', 'active');
                    applySort();
                });
            });
            
            // Навигация
            document.querySelectorAll('[data-section]').forEach(button => {
                button.addEventListener('click', () => {
                    showSection(button.dataset.section);
                });
            });
            
            // Мобильное меню
            document.getElementById('mobile-menu-button').addEventListener('click', toggleMobileMenu);
            document.getElementById('close-mobile-menu').addEventListener('click', toggleMobileMenu);
            
            // Модальные окна
            document.getElementById('close-modal').addEventListener('click', hideCarDetails);
            document.getElementById('close-cart-modal').addEventListener('click', hideCart);
            document.getElementById('close-auth-modal').addEventListener('click', hideAuth);
            document.getElementById('close-checkout-modal').addEventListener('click', hideCheckout);
            
            document.getElementById('cart-button').addEventListener('click', showCart);
            document.getElementById('login-btn').addEventListener('click', showAuth);
            document.getElementById('logout-btn').addEventListener('click', logoutUser);
            document.getElementById('checkout-btn').addEventListener('click', showCheckout);
            document.getElementById('clear-cart-btn').addEventListener('click', clearCart);
            document.getElementById('confirm-order-btn').addEventListener('click', () => {
                hideCheckout();
                cart = [];
                updateCartCount();
                showNotification('Заказ успешно оформлен! Спасибо за покупку!');
            });
            
            // Добавляем обработчик для кнопки "Добавить в корзину" в модальном окне
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('add-to-cart-modal')) {
                    if (currentCarInModal) {
                        addToCart(currentCarInModal.id);
                        hideCarDetails();
                    }
                }
            });
            
            // Переключение темы
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            
            // Переключение вкладок авторизации
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    switchAuthTab(tab.dataset.tab);
                });
            });
            
            // Выбор способа оплаты
            document.querySelectorAll('.payment-card').forEach(card => {
                card.addEventListener('click', () => {
                    selectPaymentMethod(card.dataset.payment);
                });
            });
            
            // Формы авторизации
            document.getElementById('login-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = e.target.querySelector('input[type="text"]').value;
                loginUser(username);
            });
            
            document.getElementById('register-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = e.target.querySelectorAll('input[type="text"]')[1].value;
                loginUser(username);
            });
            
            // Закрытие модальных окон при клике вне их области
            document.getElementById('car-modal').addEventListener('click', (e) => {
                if (e.target.id === 'car-modal') {
                    hideCarDetails();
                }
            });
            
            document.getElementById('cart-modal').addEventListener('click', (e) => {
                if (e.target.id === 'cart-modal') {
                    hideCart();
                }
            });
            
            document.getElementById('auth-modal').addEventListener('click', (e) => {
                if (e.target.id === 'auth-modal') {
                    hideAuth();
                }
            });
            
            document.getElementById('checkout-modal').addEventListener('click', (e) => {
                if (e.target.id === 'checkout-modal') {
                    hideCheckout();
                }
            });
        });
    </script>

</body>
</html>
